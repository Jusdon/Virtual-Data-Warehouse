{{#each individualSourceToTargetMapping}}
--
-- Staging Area View definition for {{targetTable}}
-- Generated at {{../generationDateTime}}
--

GO
USE [{{../metadataConfiguration.psaDatabaseName}}]
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[{{../metadataConfiguration.vedwSchemaName}}].[{{targetTable}}]') AND type in (N'V'))
DROP VIEW [{{../metadataConfiguration.vedwSchemaName}}].[{{targetTable}}]
GO

CREATE VIEW [{{../metadataConfiguration.vedwSchemaName}}].[{{targetTable}}] AS
AS
SELECT
  {{#each columnMapping}}
  {{sourceColumn.columnName}} AS {{targetColumn.columnName}}{{#unless @last}},{{/unless}}
  {{/each}}
FROM {{sourceTable}}
WHERE 1=1
    {{#if filterCriterion}} AND {{filterCriterion}}{{/if}}
{{/each}}

